<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <ul id="ul"></ul>
    <script>
      /* 组合模式
           将对象组合成树形结构以表示'部分-整体'的层次结构.组合模式使得用户对单个对象和组合对象的使用具有一致性;

         */
      function Foo(name) {
        this.name = name;
        this.childs = [];
      }
      function Bar(name) {
        this.name = name;
      }
      Foo.prototype.add = function(name) {
        this.childs.push(name);
      };

      var root = new Foo("组合对象1-1");
      var leaf1 = new Bar("叶子对象2-1");
      root.add(leaf1);
      var comp1 = new Foo("组合对象2-2");
      root.add(comp1);
      var comp2 = new Foo("组合对象3-1");
      var comp3 = new Foo("组合对象3-2");
      comp1.add(comp2);
      comp1.add(comp3);
      var comp4 = new Foo("组合对象4-1");
      var comp5 = new Foo("组合对象4-2");
      comp2.add(comp4);
      comp2.add(comp5);
      var comp6 = new Foo("组合对象4-3");
      var comp7 = new Foo("组合对象4-4");
      comp3.add(comp6);
      comp3.add(comp7);

      var ul = document.getElementById("ul");
      show(root);
      function show(node) {
        console.log(node.name);
        if (!node.childs) {
          return;
        }
        for (var i = 0; i < node.childs.length; i++) {
          show(node.childs[i]);
        }
      }
      //   demo
      /*  show(root, ul);
      function show(node, parent) {
        var li = document.createElement("li");
        li.innerText = node.name;
        parent.appendChild(li);
        if (!node.childs) {
          return;
        }
        for (var i = 0; i < node.childs.length; i++) {
          var childUl = document.createElement("ul");
          li.appendChild(childUl);
          show(node.childs[i], childUl);
        }
      }

      ul.onclick = function(ev) {
        if (ev.target.nodeName.toLowerCase() == "li") {
          var child = ev.target.children;

          for (var i = 0; i < child.length; i++) {
            if (child[i].nodeName.toLowerCase() == "ul" && !child[i].flag) {
              child[i].style.display = "none";
              child[i].flag = true;
            } else if (child[i].nodeName.toLowerCase() == "ul") {
              child[i].style.display = "block";
              child[i].flag = false;
            }
          }
        }
      }; */
    </script>
  </body>
</html>
